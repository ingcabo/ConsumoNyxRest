
//'Header add Access-Control-Allow-Headers "origin, x-requested-with, content-type, X-PINGOTHER,*"
var interceptor = function($q){
return{

		request: function(config){
				console.log(config);
			//	config.url= config.url.replace('apiRestCodeigniter','langalanga');
				config.headers['Access-Control-Allow-Origin']	 ='*';
				config.headers['X-Requested-With'] = 'XMLHttpRequest';

					
				if (config.url.indexOf('?cod_afiliacion') >= 0){
				config.headers['Authorization']	 ='Basic';
				config.headers['clave'] 	 = 'cosmeticoben';
				config.headers['Usuario']  	 = 'Cosmetico1.';
				
				

				}
				

				return config;	
		},

		response: function (result) {
                console.log('Repos:');

                //modify the $http response data
                //result.data.splice(0, 10).forEach(function (repo) {
           	     console.log(result);
              //  })
                return result;
            },
		responseError:function(rejection){
			console.log('Failed with',rejection,'status');
			//return $q.rejection(rejection);	

		}

	}

};




var app = angular.module('angularTable',['angularUtils.directives.dirPagination','ngResource']);


app.config(function ($httpProvider) { 

//$httpProvider.defaults.useXDomain = true;
//delete $httpProvider.defaults.headers.common['X-Requested-With'];

//  $httpProvider.defaults.headers.common['X-Requested-With'] = 'XMLHttpRequest';
$httpProvider.interceptors.push(interceptor);
 



});


app.controller('listdata',function($scope,$http,$window){


				
			//	$scope.products =$scope.pt;
				$scope.url      = 'http://www.nyxvzla.com/nyxapiRest/index.php/Myrest/lote';
	
				
				$scope.refe2   = '';
			
				$scope.myVar   =    $scope.myVar;
				$scope.urll = 'no';
				




				$scope.proceder=function () {



				  			

                  $scope.paramt = {};
                  $scope.compra = $scope.pt;

				  $scope.lote =     {
										 
											'nombres'        :     $scope.Miembro.nombres,
											'email'          :     $scope.Miembro.email,
											'telefono'       :     $scope.Miembro.telefono,
											'doc_identidad'  :     $scope.Miembro.doc_identidad,
											'datos_env'      :     $scope.Miembro.datos_env,
											'monto_total'    :     $scope.total_lote
											
										

											};



				
			

				   $scope.lote = $scope.lote;
				   $scope.compra = $scope.compra;
							


					


					$scope.paramt=  {'lote': $scope.lote, 'compra' : $scope.compra};						
											
									$scope.addCompra($scope.paramt);
								


				};


				$scope.addCompra=function(){


											$http.put($scope.url,$scope.paramt)
											.success(function(data,status,headers,config){
											
											//las variables numero de factura y monto
											$scope.refe  = data.Rerencia;

											

											$scope.total = data.total_lote;

											



											 $window.location.href = 'botonpago/PreRegistro.php?factura=' + $scope.refe + '&monto=' + $scope.total;
											//obtener resultados a partir de el numero de control y monto
											
											
											$scope.myVar =  !$scope.myVar;
										
					
   										//	console.log(data);
											
											})
											.error(function(error,status,headers,config){
											
										//	console.log(error);
											});

				};



		



/*

ok por favor utiliza estos datos
 
desde la url de preregistro cambia el cod de afiliacion a  20150311
 
login: unetachira
pass: 123Tachira*

CARLOS CARLOS
 
estas son las credenciales yo las prob√© en postman
 
 
con respecto a lo de la activacion cors, estoy esperando que llegue personal de desarrollo para esto, ya te informo.
 



*/


});

